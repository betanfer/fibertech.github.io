<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Obras - Portal</title>
    <link rel="stylesheet" href="css/gestion_style03.css"> 
</head>
<body>
    <div class="header">
        <h1>Gestión de Obra - Dashboard</h1>
        <p id="currentUserRole" class="user-info">Cargando perfil...</p>
        <a href="index.html" class="logout-button">Cerrar Sesión</a>
    </div>

    <div class="container">
        <!-- SECCIÓN 01: DATOS DE LA OBRA -->
        <div class="card obra-form">
            <h2>Datos de la Obra</h2>
            <form id="obraForm">
                <input type="hidden" id="obraId" value=""> <!-- Campo oculto para ID de Modificación/Baja -->

                <div class="input-group">
                    <label for="nodo">Nodo:</label>
                    <input type="text" id="nodo" required>
                </div>
                
                <div class="input-group">
                    <label for="estado">Estado:</label>
                    <select id="estado" required>
                        <option value="Pendiente">Pendiente</option>
                        <option value="En Proceso">En Proceso</option>
                        <option value="Completado">Completado</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="oc_numero">Número de Orden de Compra:</label>
                    <input type="text" id="oc_numero" required>
                </div>
                
                <div class="input-group">
                    <label for="oc_valor">Valor de la OC:</label>
                    <input type="number" id="oc_valor" step="0.01" required>
                </div>
                
                <div class="input-group">
                    <label for="importe_70">Importe al 70%:</label>
                    <input type="number" id="importe_70" step="0.01" readonly>
                </div>
                
                <div class="input-group">
                    <label for="importe_30">Importe al 30%:</label>
                    <input type="number" id="importe_30" step="0.01" readonly>
                </div>
                
                <div class="input-group">
                    <label for="cuadrilla">Cuadrilla:</label>
                    <input type="text" id="cuadrilla" required>
                </div>

                <div class="action-buttons">
                    <button type="submit" id="btnAlta" class="action-button alta">Guardar Obra (Alta)</button>
                    <button type="button" id="btnModificacion" class="action-button modificacion" style="display:none;">Actualizar Obra</button>
                    <button type="button" id="btnBaja" class="action-button baja" style="display:none;">Eliminar Obra (Baja)</button>
                </div>
                <!-- Botón para cancelar edición/alta -->
                <button type="button" id="btnCancelar" class="action-button cancel" style="display:none; width: 100%; margin-top: 10px;">Cancelar</button>
            </form>
        </div>

        <!-- SECCIÓN 02: LISTADO DE OBRAS -->
        <div class="card obra-list">
            <h2>Listado de Obras</h2>
            <div class="list-header">
                <button id="btnExportar" class="action-button exportar">Exportar a Excel</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Nodo</th>
                        <th>Estado</th>
                        <th>Valor OC</th>
                        <th>70\%</th>
                        <th>30\%</th>
                        <th>Cuadrilla</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="obrasTableBody">
                    <!-- Filas de obras se cargarán aquí -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="js/gestion_script05.js"></script>
</body>
</html>